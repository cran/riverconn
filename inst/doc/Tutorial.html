<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Damiano Baldan" />

<meta name="date" content="2024-01-23" />

<title>riverconn vignette</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">riverconn vignette</h1>
<h4 class="author">Damiano Baldan</h4>
<h4 class="date">2024-01-23</h4>


<div id="TOC">
<ul>
<li><a href="#indices-to-assess-riverscape-connectivity" id="toc-indices-to-assess-riverscape-connectivity"><span class="toc-section-number">1</span> Indices to assess riverscape
connectivity</a>
<ul>
<li><a href="#the-river-network-as-a-graph" id="toc-the-river-network-as-a-graph"><span class="toc-section-number">1.1</span> The river network as a
graph</a></li>
<li><a href="#generalized-riverscape-connectivity-index" id="toc-generalized-riverscape-connectivity-index"><span class="toc-section-number">1.2</span> Generalized riverscape
connectivity index</a>
<ul>
<li><a href="#catchment-connectvity-index" id="toc-catchment-connectvity-index"><span class="toc-section-number">1.2.1</span> Catchment Connectvity
index</a></li>
<li><a href="#reach-connectivity-index" id="toc-reach-connectivity-index"><span class="toc-section-number">1.2.2</span> Reach Connectivity
Index</a></li>
<li><a href="#node-weights" id="toc-node-weights"><span class="toc-section-number">1.2.3</span> Node weights</a></li>
</ul></li>
<li><a href="#dispersal-probability" id="toc-dispersal-probability"><span class="toc-section-number">1.3</span> Dispersal probability</a>
<ul>
<li><a href="#structural-connectivity" id="toc-structural-connectivity"><span class="toc-section-number">1.3.1</span> Structural connectivity</a></li>
<li><a href="#functional-connectivity" id="toc-functional-connectivity"><span class="toc-section-number">1.3.2</span> Functional connectivity</a></li>
</ul></li>
<li><a href="#prioritization-of-barriers" id="toc-prioritization-of-barriers"><span class="toc-section-number">1.4</span> Prioritization of
barriers</a></li>
<li><a href="#time-dependent-connectivity" id="toc-time-dependent-connectivity"><span class="toc-section-number">1.5</span> Time-dependent
connectivity</a></li>
</ul></li>
<li><a href="#preprocessing-of-input-data" id="toc-preprocessing-of-input-data"><span class="toc-section-number">2</span> Preprocessing of input data</a>
<ul>
<li><a href="#preliminary-steps" id="toc-preliminary-steps"><span class="toc-section-number">2.1</span> Preliminary steps</a></li>
<li><a href="#input-class-igraph-object" id="toc-input-class-igraph-object"><span class="toc-section-number">2.2</span> Input class ‘igraph’
object</a></li>
<li><a href="#decorating-the-class-igraph-object" id="toc-decorating-the-class-igraph-object"><span class="toc-section-number">2.3</span> Decorating the class ‘igraph’
object</a></li>
<li><a href="#assigning-network-directionality" id="toc-assigning-network-directionality"><span class="toc-section-number">2.4</span> Assigning network
directionality</a></li>
</ul></li>
<li><a href="#indices-calculation" id="toc-indices-calculation"><span class="toc-section-number">3</span> Indices calculation</a></li>
<li><a href="#barriers-prioritization-calculation" id="toc-barriers-prioritization-calculation"><span class="toc-section-number">4</span> Barriers prioritization
calculation</a></li>
<li><a href="#references-and-key-literature" id="toc-references-and-key-literature"><span class="toc-section-number">5</span> References and key
literature</a></li>
</ul>
</div>

<div id="indices-to-assess-riverscape-connectivity" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Indices to assess
riverscape connectivity</h1>
<p>The riverconn package is used to calculate indices for river network
connectivity. For a review of the indices, see <a href="https://doi.org/10.1088/1748-9326/abcb37">Jumani et al., 2021</a>,
while for a list of the functionalities of the package and its
architecture, see <a href="https://doi.org/10.1016/j.envsoft.2022.105470">Baldan et al.,
2022</a>.</p>
<p>If you use this package, cite it as: <a href="https://doi.org/10.1016/j.envsoft.2022.105470" class="uri">https://doi.org/10.1016/j.envsoft.2022.105470</a>.</p>
<p>For a tutorial on how to generate graphs representing rivers from
“real world” data see: <a href="https://damianobaldan.github.io/riverconn_tutorial/" class="uri">https://damianobaldan.github.io/riverconn_tutorial/</a></p>
<div id="the-river-network-as-a-graph" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> The river network as
a graph</h2>
<p>This package implements algorithms to compute commonly used indices
to assess river networks connectivity All those indices assume a
conceptualization of the river networks as a graph <span class="math inline">\(L = (E,V)\)</span>, where vertices (nodes) <span class="math inline">\(V\)</span> represent single reaches, and edges
(links) <span class="math inline">\(E\)</span> represent either
confluences or longitudinal barriers.</p>
<p>For example, the graphs below represents a river with ten reaches.
The graph on the left is directed, i.e. edges are defined for ordered
pair of vertices. The graph on the right is undirected, as the order of
vertices for the definition of edges is unimportant. Both graph have a
‘tree-like’ structure, since no loops exist (acyclic graphs): this
structure can be used to describe a river system. In both examples, both
barriers and confluences are present. The edges between nodes 1 and 2
and 3 and 2 are confluences. The edge between node 2 and 4 is a
barrier.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABiVBMVEUAAAAAACAAAE4AAGMAAHcAAH4AAIsAAI0AAI4AAJEAAJUAAJYAAJ8AALMADakAF4sAGU4AG5MAIp8AJE4AJIsAJpgAJpsAKJ8AKqkAOr0AOscARJ8AZtoQAIsQJpwXAIsbX6QcAIsmAIsmAJEmRJEmRJ8mX6QmaKkokO0qkO0xAIsyAJ80JE40WiA6AIs6AJ86Osc6RJE6Zto6kO06nf9EAItEAJFEAJVEIZNEJptEealJOotSJpVSkalYAItYZp9fJotfkalmAItmAJ9mALNmMalmOsdmtv9oJo1oX5F5RIt5RI95qal72/99qamBiTiQOouQOrOQtv+Q2/+RUo+RX5GRkZuRqZ+RqamcOpGdkJ+d//+pVo+paJGpeZOpeZWpkZWpkZupkaSpqZ+pqaSpqam2Zou2Zpm2/9q2//+8///FWnfbfJXbkJzbkJ/btrPb28fb/9rb///mcmPmiU7mnwDmnyDmnzj/gZn/gab/tqb/tq3/trP/27P/28f/2+3//9r//+3///8ZfBMxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGCElEQVR4nO3b+1sUVRyA8dXspKRZWVSAeckultEF7YJWSBeKrEijqDQ0GIosMhQzI1rmL+/M7GKY1gvjDLP0vO/zuCy/7H6fD7PnnGWxkdp/1qh7gE5PIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggqGKgpNqH34CqBtr0QpUDbXahkoGS1bW/LfcZNrqyr6CbfNK/723aqgNa/V3JT7KRlb4G3eYC2tRC5S/StwXavEJVAv1jxd6clb2LpatW5v8BT+lA02M98xnI1LEQBjsAZznOk31tDocwUugRygVqHgs9E5nPq6eS8a5TtQNFlxyo+c5sOrdrtshDlP0SG+/OgL6NN1OvnFzlUxfTXA70Z7xpvn2myAOUDbRtz0TrumlceTLpAKBte+ZbdxpXXi70AOUDfdFafrYemRgN4anp9iIwXnQNuMO27fmltfxsPTI/E8LAyqI0t9Z5Sn+JPXxiNhkPgxEk9Ma1el9rEZjsmm0O1yE099iJuPyEkQgS+uKa1J5ncdda5ykd6IE3kmR6qDdJPgv7k2Sy64PuOND00GAcqme+3CdbS3OPfpTEvawvSX8MhzOYr7IplsdG1jpPBYt02lgYjUDfhP2NhQsHX4pjNK48cTJNl14otEreWdki3ViY6U3T38PhxsJS/1v5PNkoa5unEqCrQ3ERmgxPZ0BxoKRxuetUtufW8BrLga4OZRdMOHoD6HK25a9tnrKBRuM2n5677+MkOb833p3cfiBbiyZrA5rJXkfn7vshTf/YF39Ui10HsrVosi6geFAMO05OPftgXBK7Pz8Yb+8J2Z6WAy31bzhQdoDeeaaZz9NzqT/e7oj/RpLFDGht81TxG8X3D7Xeb8TVeuzx8exofaG2NSjry0Mry/FyNs980hqlnjUodnbLxe5Lp3Og8UdCuH8i29YGVw61G9+1LRd7Lp3O787l87R3sbXNU/6vO67Hizh0zWY8Yfvx/DiUb6n1nIPa8+Tvw34K9x7Pj0Prmad0oOxElqOc3xv2p9m7+nA0XcfJtaJ5skU6PJMvkuubp3SgpdPZxTsRD9G97bdiM31lP8f655lPpob72h/TrW+e0oFm8p9YGBntaiy03qku1gq0Ms9MNk+6/nkq+eAw/sSab2Zj7cz2icV6XlslzVMVUL40hp1fx2v8xXo2r5LmqQrot11xHzsb9oVQ0+Z+6zxpcq3APFV9Nh/Pqo2FDzf+7Pxv5fN8V2CeqoDiKaPx62vP1XR2vrV8nncLzFPZX3dk54/dte5fN1d0nsqAZnaH8FAHARWdpyqg5bGB5us/d8AC3a7wPNUB9dz1/NxARY++/grPU9lLbKn/7k/e65gLqPg81f0J3vVQ7KPMqio4T2VAy59+P9xJQkXnqW4XG2j/QrhDKjpPhQfF1t8MdEiF56lwF5uv56PC21d4nurWoLGOeJ96o6Lz+H81IIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBoL8AsbaOPjClTCEAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="generalized-riverscape-connectivity-index" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Generalized
riverscape connectivity index</h2>
<p>river networks-level connectivity can be expressed in terms of
coincidence probability (Pascual-Hortal and Saura, 2006), i.e. the
probability that two random points in a river network are connected.
Once the dispersal probability <span class="math inline">\(I_{ij}\)</span> is defined for each couple of
<span class="math inline">\(i,j\)</span> nodes in the graph, generalized
connectivity indices for catchment and reach scales can be
calculated.</p>
<div id="catchment-connectvity-index" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Catchment
Connectvity index</h3>
<p>The catchment-scale connectivity index (CCI) is calculated as:</p>
<p><span class="math display">\[
\ CCI = \sum_{i = 1}^{n} \sum_{j = 1}^{n} I_{ij} \frac{w_i w_j}{W^2}
\]</span> Where <span class="math inline">\(w_i\)</span> and <span class="math inline">\(w_j\)</span> are some node-level attributes
(weights), and <span class="math inline">\(W\)</span> is the sum of sum
of the nodes weights for the whole river networks.</p>
</div>
<div id="reach-connectivity-index" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Reach Connectivity
Index</h3>
<p>The reach-scale connectivity index (RCI) is calculated by limiting
the summation to all the connections to the single node <span class="math inline">\(i\)</span>. <span class="math display">\[
\ RCI_i = \sum_{j = 1}^{n} I_{ij} \frac{w_j}{W}
\]</span> Where <span class="math inline">\(w_j\)</span> are some
node-level attributes (weights), and <span class="math inline">\(W\)</span> is the sum of sum of the nodes weights
for the whole river networks.</p>
</div>
<div id="node-weights" class="section level3" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Node weights</h3>
<p>Nodes weights can be arbitrarily chosen. Common features used are the
reach length <span class="math inline">\(l_i\)</span>, area <span class="math inline">\(A_i\)</span>, or volume <span class="math inline">\(V_i\)</span>. Alternatively, the habitat
suitability index (HSI) can be used, defined as the ratio of length/area
that is suitable for a specific organism. <span class="math display">\[
\ HSI_i = \frac{{l}_{i,suitable}}{l_i}
\]</span> Here <span class="math inline">\({l}_{i,suitable}\)</span> is
the fraction of reach length of reach <span class="math inline">\(i\)</span> that are suitable, and are usually
referred to as weighted suitable length or weighted suitable area.</p>
</div>
</div>
<div id="dispersal-probability" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Dispersal
probability</h2>
<p>The dispersal probability depends on several factors: the presence of
barriers between nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> , the presence of suitable habitats in
nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> and alongside the connection, and the
distance between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. The dispersal probability <span class="math inline">\(I_{ij}\)</span> is thus determined by several
contributions. Those contributions are multiplied:</p>
<p><span class="math display">\[
\ I_{ij} = c_{ij}B_{ij}
\]</span> where <span class="math inline">\(c_{ij}\)</span> accounts for
the structural connectivity, i.e. it depends exclusively on the presence
of barriers between nodes <span class="math inline">\(i\)</span> and
<span class="math inline">\(j\)</span>, and <span class="math inline">\(B_{ij}\)</span> accounts for the functional
connectivity, i.e. it depends exclusively on the distance and the
organisms movement/dispersal abilities.</p>
<div id="structural-connectivity" class="section level3" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Structural
connectivity</h3>
<p>The structural connectivity depends on the presence of barriers
between nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, and can be expressed as a function of
the types of barriers present in the path expressed as a sequence of
passability values. The passability <span class="math inline">\(p_m\)</span> for the <span class="math inline">\(m\)</span>-th barrier is defined as the
probability that the reaches immediately upstream and downstream the
barrier <span class="math inline">\(m\)</span> are connected.</p>
<p>If the flow directionality is not relevant (i.e. the river graph can
be conceptualized as undirected),</p>
<p><span class="math display">\[
\ c_{ij} = \prod_{m = 1}^{k} p_m^u p_m^d
\]</span> Where the product extends over the <span class="math inline">\(k\)</span> nodes that are part of the path
connecting reaches <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, <span class="math inline">\(p_m^u\)</span> is the upsstream passability of the
<span class="math inline">\(m\)</span>-th barrier and <span class="math inline">\(p_m^u\)</span> is the upstream passability of the
<span class="math inline">\(m\)</span>-th barrier. This definition based
solely on products yields a symmetric coincidence probability
(i.e. <span class="math inline">\(c_{ij} = c_{ji}\)</span>).</p>
<p>A directional version of <span class="math inline">\(c_{ij}\)</span>
can be defined as: <span class="math display">\[
\ c_{ij} = \prod_{m = 1}^{k} p_m^{eq}
\]</span> <span class="math display">\[
p_m^{eq} = \begin{cases}
p_m^u &amp; \mbox{if barrier m is encountered moving upstream in the
path from i to j } \\
p_m^d &amp; \mbox{if barrier m is encountered moving downstream in the
path from i to j }
\end{cases}
\]</span> If <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are located in different
sub-catchments, the path from i to j will be moving downstream in some
sections and upstream in some other secions: this <span class="math inline">\(p_m^{eq}\)</span> definition ensures the retained
passability value is consistent with the directionality of the path from
<span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> (i.e. <span class="math inline">\(c_{ij} \ne c_{ji}\)</span>)</p>
</div>
<div id="functional-connectivity" class="section level3" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Functional
connectivity</h3>
<p>Functional connectivity can be calculated as a function of the
distance between reaches. An exponential dispersal kernel can be
used:</p>
<p><span class="math display">\[
\ B_{ij} = PD^{d_{ij}}
\]</span> where <span class="math inline">\(PD\)</span> is in the <span class="math inline">\((0,1)\)</span> interval (smaller values mean more
restricted movement), and <span class="math inline">\(d_{ij}\)</span> is
the distance between reaches <span class="math inline">\(i\)</span> and
<span class="math inline">\(j\)</span>. Alternatively, a threshold based
probability can be used: <span class="math display">\[
\ B_{ij} = \begin{cases}
0 &amp; \mbox{when } d_{ij}&gt;d_{tr}  \\
1 &amp; \mbox{when } d_{ij}&lt;=d_{tr}  
\end{cases}
\]</span> Both definitions can be easily adapted to asymmetric dispersal
by defining <span class="math inline">\(PD_{d}\)</span>, <span class="math inline">\(PD_{u}\)</span>, <span class="math inline">\(d_{tr,u}\)</span>, and <span class="math inline">\(d_{tr,d}\)</span>, and calculating <span class="math inline">\(B_{ij} = B_{ij}^u B_{ij}^d\)</span> where <span class="math inline">\(B_{ij}^u\)</span> and <span class="math inline">\(B_{ij}^d\)</span> are the index <span class="math inline">\(B_{ij}\)</span> contribution calculated for the
‘downstream moving’ and ‘upstream moving’ sections in the path from
reach <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span>.</p>
<p>The distance <span class="math inline">\(d_{ij}\)</span> can be
either the geometric distance, or any other measure of effective
distance (e.g. <span class="math inline">\(d_{ij} /
(1-{HSI}_{ij})\)</span> provides an estimate of effective distance that
depends on the habitat suitability index between reaches <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>)</p>
</div>
</div>
<div id="prioritization-of-barriers" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Prioritization of
barriers</h2>
<p>All the defined connectivity index can be used to prioritize barriers
removal with a ‘leave-one-out’ approach. For each barrier, the index
<span class="math inline">\(dCCI\)</span> can be defined as: <span class="math display">\[
\ dCCI_{m} = 100 \frac{CCI - CCI_{m, removed}}{GCI}
\]</span> where <span class="math inline">\(CCI\)</span> is the
generalized connectivity index calculated for the original river
networks with all the barriers implemented, and CCI_{m, removed} is the
index recalculated when barrier <span class="math inline">\(m\)</span>
is removed or its passability is changed (an equivalent for the reach
scale, <span class="math inline">\(dRCI_{i}\)</span>, can be defined
similarly) .</p>
<p>An alternative version of the index for prioritizing barriers can be
calculated as the decrease in river networks connectivity after a single
barrier is implemented, with a ‘add-one’ approach.</p>
</div>
<div id="time-dependent-connectivity" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Time-dependent
connectivity</h2>
<p>When barriers metadata on the year of construction and the year of
implementation of mitigation measures are available, a time trajectory
of GCI can be computed (e.g. Segurado et al., 2013).</p>
</div>
</div>
<div id="preprocessing-of-input-data" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Preprocessing of input
data</h1>
<p>This package relies heavily on the functionalities of the
<code>igraph</code> package. The <code>igraph</code> package implements
routines for simple graphs and network analysis. It can handle large
graphs very well and provides functions for generating random and
regular graphs, graph visualization, centrality methods and much more.
The package allows for easy construction of <code>igraph</code> objects
based on edges and vertices lists or adjacency matrices. The book
‘Statistical Analysis of Network Data with R’ by Kolaczyk and Csardi
(2014) offers a comprehensive tutorial on the possibilities offered by
the ‘igraph’ package.</p>
<p>A more comprehensive tutorial, including a real-world case study can
be found here: <a href="https://damianobaldan.github.io/riverconn_tutorial/" class="uri">https://damianobaldan.github.io/riverconn_tutorial/</a></p>
<div id="preliminary-steps" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Preliminary
steps</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(riverconn)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span></code></pre></div>
</div>
<div id="input-class-igraph-object" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Input class ‘igraph’
object</h2>
<p>All the functions implemented in this package use as main input an
object of class <code>igraph</code>. There are different ways an object
of class <code>igraph</code> can be created. A symbolic sequence of
edges can be used with the function <code>graph_from_literal</code> for
small, toy graphs.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph_from_literal</span>(<span class="dv">1</span><span class="sc">-+</span><span class="dv">2</span>, <span class="dv">2</span><span class="sc">-+</span><span class="dv">5</span>, <span class="dv">3</span><span class="sc">-+</span><span class="dv">4</span>, <span class="dv">4</span><span class="sc">-+</span><span class="dv">5</span>, <span class="dv">6</span><span class="sc">-+</span><span class="dv">7</span>, <span class="dv">7</span><span class="sc">-+</span><span class="dv">10</span>, <span class="dv">8</span><span class="sc">-+</span><span class="dv">9</span>, <span class="dv">9</span><span class="sc">-+</span><span class="dv">10</span>, </span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>                        <span class="dv">5</span><span class="sc">-+</span><span class="dv">11</span>, <span class="dv">11</span><span class="sc">-+</span><span class="dv">12</span>, <span class="dv">10</span><span class="sc">-+</span><span class="dv">13</span>, <span class="dv">13</span><span class="sc">-+</span><span class="dv">12</span>, <span class="dv">12</span><span class="sc">-+</span><span class="dv">14</span>, <span class="dv">14</span><span class="sc">-+</span><span class="dv">15</span>, <span class="dv">15</span><span class="sc">-+</span><span class="dv">16</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>g</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="do">## IGRAPH cfc7356 DN-- 16 15 -- </span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="do">## + attr: name (v/c)</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="do">## + edges from cfc7356 (vertex names):</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="do">##  [1] 1 -&gt;2  2 -&gt;5  5 -&gt;11 3 -&gt;4  4 -&gt;5  6 -&gt;7  7 -&gt;10 10-&gt;13 8 -&gt;9  9 -&gt;10</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="do">## [11] 11-&gt;12 12-&gt;14 13-&gt;12 14-&gt;15 15-&gt;16</span></span></code></pre></div>
<p>Note that when a graph is defined this way, edged and vertices
attributes are not defined.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Edges</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">E</span>(g)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="do">## + 15/15 edges from cfc7356 (vertex names):</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="do">##  [1] 1 -&gt;2  2 -&gt;5  5 -&gt;11 3 -&gt;4  4 -&gt;5  6 -&gt;7  7 -&gt;10 10-&gt;13 8 -&gt;9  9 -&gt;10</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="do">## [11] 11-&gt;12 12-&gt;14 13-&gt;12 14-&gt;15 15-&gt;16</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co"># vertices</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">V</span>(g)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="do">## + 16/16 vertices, named, from cfc7356:</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="do">##  [1] 1  2  5  3  4  6  7  10 8  9  11 12 13 14 15 16</span></span></code></pre></div>
<p>The graph can be converted to data frame with the function
<code>as_data_frame</code>, specifying if edges or vertices are to be
exported. Accordingly, the function <code>graph_from_data_frame</code>
can be used to create an igraph object from a data frame.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">as_data_frame</span>(g, <span class="at">what =</span> <span class="st">&quot;edges&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="do">##    from to</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="do">## 1     1  2</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="do">## 2     2  5</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="do">## 3     5 11</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="do">## 4     3  4</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="do">## 5     4  5</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="do">## 6     6  7</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="do">## 7     7 10</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="do">## 8    10 13</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="do">## 9     8  9</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="do">## 10    9 10</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="do">## 11   11 12</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="do">## 12   12 14</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="do">## 13   13 12</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="do">## 14   14 15</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="do">## 15   15 16</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">as_data_frame</span>(g, <span class="at">what =</span> <span class="st">&quot;vertices&quot;</span>)</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="do">##    name</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="do">## 1     1</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="do">## 2     2</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="do">## 5     5</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="do">## 3     3</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="do">## 4     4</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="do">## 6     6</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="do">## 7     7</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="do">## 10   10</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="do">## 8     8</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="do">## 9     9</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="do">## 11   11</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="do">## 12   12</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="do">## 13   13</span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="do">## 14   14</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="do">## 15   15</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a><span class="do">## 16   16</span></span></code></pre></div>
<p>Finally, an igraph object can be exported to and generated from
adjacency matrices using the functions <code>as_adjacency_matrix</code>
and <code>graph_from_adjacency_matrix</code>, specifying if edges or
vertices are to be exported.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>igraph<span class="sc">::</span><span class="fu">as_adjacency_matrix</span>(g)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="do">## 16 x 16 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="do">##                                   </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="do">## 1  . 1 . . . . . . . . . . . . . .</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="do">## 2  . . 1 . . . . . . . . . . . . .</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="do">## 5  . . . . . . . . . . 1 . . . . .</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="do">## 3  . . . . 1 . . . . . . . . . . .</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="do">## 4  . . 1 . . . . . . . . . . . . .</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="do">## 6  . . . . . . 1 . . . . . . . . .</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="do">## 7  . . . . . . . 1 . . . . . . . .</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="do">## 10 . . . . . . . . . . . . 1 . . .</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="do">## 8  . . . . . . . . . 1 . . . . . .</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="do">## 9  . . . . . . . 1 . . . . . . . .</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="do">## 11 . . . . . . . . . . . 1 . . . .</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="do">## 12 . . . . . . . . . . . . . 1 . .</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="do">## 13 . . . . . . . . . . . 1 . . . .</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="do">## 14 . . . . . . . . . . . . . . 1 .</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="do">## 15 . . . . . . . . . . . . . . . 1</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="do">## 16 . . . . . . . . . . . . . . . .</span></span></code></pre></div>
</div>
<div id="decorating-the-class-igraph-object" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Decorating the class
‘igraph’ object</h2>
<p>Once the structure of the network is defined, the graph can be
decorated with edges and vertices attributes. Attributes can be either
added directly to the graph or joined to the edges and vertices data
frame. edges and vertices attributes are saved as vectors, so common,
data.frame-like operations are possible.</p>
<p>Here we add the dam information as edge attribute, including the
field ‘id_dam’, and the reach information data as vertices attributes,
including the length and the corresponding habitat suitability
index.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Decorate edges </span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">E</span>(g)<span class="sc">$</span>id_dam <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="cn">NA</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="cn">NA</span>, <span class="st">&quot;4&quot;</span>, <span class="cn">NA</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="cn">NA</span>,  <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">&quot;7&quot;</span>, <span class="cn">NA</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">E</span>(g)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(<span class="fu">E</span>(g)<span class="sc">$</span>id_dam), <span class="st">&quot;joint&quot;</span>, <span class="st">&quot;dam&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">E</span>(g)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="do">## + 15/15 edges from cfc7356 (vertex names):</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="do">##  [1] 1 -&gt;2  2 -&gt;5  5 -&gt;11 3 -&gt;4  4 -&gt;5  6 -&gt;7  7 -&gt;10 10-&gt;13 8 -&gt;9  9 -&gt;10</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="do">## [11] 11-&gt;12 12-&gt;14 13-&gt;12 14-&gt;15 15-&gt;16</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co"># Decorate vertices</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>length <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">9</span>)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>HSI <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>Id <span class="ot">&lt;-</span> <span class="fu">V</span>(g)<span class="sc">$</span>name</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="fu">V</span>(g)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="do">## + 16/16 vertices, named, from cfc7356:</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="do">##  [1] 1  2  5  3  4  6  7  10 8  9  11 12 13 14 15 16</span></span></code></pre></div>
</div>
<div id="assigning-network-directionality" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Assigning network
directionality</h2>
<p>The <code>riverconn</code> package implements the function
<code>set_graph_directionality</code> that allows to assign the
directionality of the graph once an outlet is defined.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">set_graph_directionality</span>(g, <span class="at">field_name =</span> <span class="st">&quot;Id&quot;</span>, <span class="at">outlet_name =</span> <span class="st">&quot;16&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">set_graph_directionality</span>(g, <span class="at">field_name =</span> <span class="st">&quot;Id&quot;</span>, <span class="at">outlet_name =</span> <span class="st">&quot;5&quot;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.undirected</span>(g), <span class="at">layout =</span> <span class="fu">layout_as_tree</span>(<span class="fu">as.undirected</span>(g), <span class="at">root =</span> <span class="dv">8</span>, <span class="at">flip.y =</span> <span class="cn">FALSE</span>))</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">plot</span>(g1, <span class="at">layout =</span> <span class="fu">layout_as_tree</span>(<span class="fu">as.undirected</span>(g1), <span class="at">root =</span> <span class="dv">16</span>, <span class="at">flip.y =</span> <span class="cn">FALSE</span>))</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">plot</span>(g2, <span class="at">layout =</span> <span class="fu">layout_as_tree</span>(<span class="fu">as.undirected</span>(g2), <span class="at">root =</span> <span class="dv">5</span>, <span class="at">flip.y =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">par</span>(oldpar)</span></code></pre></div>
</div>
</div>
<div id="indices-calculation" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Indices
calculation</h1>
<p>The function <code>index_calcualtion</code> is used to calculate all
the nuances of the CCI and RCI</p>
<p>Before calculation, the information on the barriers passability are
needed.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Check edged and nodes attributes, add pass_u and pass_d fields</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>g_v_df <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">as_data_frame</span>(g, <span class="at">what =</span> <span class="st">&quot;vertices&quot;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>g_v_df</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="do">##    name length HSI Id</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="do">## 1     1      1 0.2  1</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="do">## 2     2      1 0.1  2</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="do">## 5     5      2 0.3  5</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="do">## 3     3      3 0.4  3</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="do">## 4     4      4 0.5  4</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="do">## 6     6      1 0.5  6</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="do">## 7     7      5 0.5  7</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="do">## 10   10      1 0.6 10</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="do">## 8     8      7 0.7  8</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="do">## 9     9      7 0.8  9</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="do">## 11   11      3 0.8 11</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="do">## 12   12      2 0.8 12</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="do">## 13   13      4 0.8 13</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="do">## 14   14      5 0.8 14</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="do">## 15   15      6 0.8 15</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="do">## 16   16      9 0.8 16</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>g_e_df <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">as_data_frame</span>(g, <span class="at">what =</span> <span class="st">&quot;edges&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pass_u =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(id_dam),<span class="fl">0.1</span>,<span class="cn">NA</span>),</span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a>         <span class="at">pass_d =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(id_dam),<span class="fl">0.7</span>,<span class="cn">NA</span>))</span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>g_e_df</span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="do">##    from to id_dam  type pass_u pass_d</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="do">## 1     1  2      1   dam    0.1    0.7</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="do">## 2     2  5   &lt;NA&gt; joint     NA     NA</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="do">## 3     5 11      2   dam    0.1    0.7</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="do">## 4     3  4      3   dam    0.1    0.7</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="do">## 5     4  5   &lt;NA&gt; joint     NA     NA</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="do">## 6     6  7      4   dam    0.1    0.7</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="do">## 7     7 10   &lt;NA&gt; joint     NA     NA</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="do">## 8    10 13      5   dam    0.1    0.7</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="do">## 9     8  9      6   dam    0.1    0.7</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="do">## 10    9 10   &lt;NA&gt; joint     NA     NA</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="do">## 11   11 12   &lt;NA&gt; joint     NA     NA</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="do">## 12   12 14   &lt;NA&gt; joint     NA     NA</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="do">## 13   13 12   &lt;NA&gt; joint     NA     NA</span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="do">## 14   14 15      7   dam    0.1    0.7</span></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="do">## 15   15 16   &lt;NA&gt; joint     NA     NA</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="co"># Recreate graph</span></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a>g <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> g_e_df, <span class="at">vertices =</span> g_v_df)</span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a>g </span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a><span class="do">## IGRAPH d032580 DN-- 16 15 -- </span></span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a><span class="do">## + attr: name (v/c), length (v/n), HSI (v/n), Id (v/c), id_dam (e/c),</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a><span class="do">## | type (e/c), pass_u (e/n), pass_d (e/n)</span></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a><span class="do">## + edges from d032580 (vertex names):</span></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a><span class="do">##  [1] 1 -&gt;2  2 -&gt;5  5 -&gt;11 3 -&gt;4  4 -&gt;5  6 -&gt;7  7 -&gt;10 10-&gt;13 8 -&gt;9  9 -&gt;10</span></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a><span class="do">## [11] 11-&gt;12 12-&gt;14 13-&gt;12 14-&gt;15 15-&gt;16</span></span></code></pre></div>
<p>Index with default settings.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">index_calculation</span>(g, <span class="at">param =</span> <span class="fl">0.9</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="do">##        num  den    index</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="do">## 1 553.8299 3721 0.148839</span></span></code></pre></div>
<p>Index with default settings, only <span class="math inline">\(c_{ij}\)</span> or <span class="math inline">\(B_{ij}\)</span> contributions</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">index_calculation</span>(g, <span class="at">B_ij_flag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="do">##        num  den     index</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="do">## 1 791.8553 3721 0.2128071</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">index_calculation</span>(g, <span class="at">param =</span> <span class="fl">0.9</span>, <span class="at">c_ij_flag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="do">##       num  den     index</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="do">## 1 1200.63 3721 0.3226632</span></span></code></pre></div>
<p>Index with default settings, only <span class="math inline">\(B_{ij}\)</span> contributions with threshold on
the distance</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">index_calculation</span>(g, <span class="at">c_ij_flag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                  <span class="at">dir_distance_type =</span> <span class="st">&quot;asymmetric&quot;</span>, </span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                  <span class="at">disp_type =</span> <span class="st">&quot;threshold&quot;</span>, <span class="at">param_u =</span> <span class="dv">0</span>, <span class="at">param_d =</span> <span class="dv">5</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="do">##   num  den     index</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="do">## 1 453 3721 0.1217415</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">index_calculation</span>(g, <span class="at">c_ij_flag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>                  <span class="at">dir_distance_type =</span> <span class="st">&quot;asymmetric&quot;</span>, </span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>                  <span class="at">disp_type =</span> <span class="st">&quot;threshold&quot;</span>, <span class="at">param_u =</span> <span class="dv">5</span>, <span class="at">param_d =</span> <span class="dv">10</span>)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="do">##    num  den     index</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="do">## 1 1028 3721 0.2762698</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="fu">index_calculation</span>(g, <span class="at">c_ij_flag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>                  <span class="at">dir_distance_type =</span> <span class="st">&quot;symmetric&quot;</span>, </span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>                  <span class="at">disp_type =</span> <span class="st">&quot;threshold&quot;</span>, <span class="at">param =</span> <span class="dv">10</span>)</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="do">##    num  den    index</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="do">## 1 1239 3721 0.332975</span></span></code></pre></div>
<p>Index for reach, inbound connections used, only <span class="math inline">\(B_{ij}\)</span> contributions with threshold on
the distance</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">index_calculation</span>(g, <span class="at">c_ij_flag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>                  <span class="at">index_type =</span> <span class="st">&quot;reach&quot;</span>, <span class="at">index_mode =</span> <span class="st">&quot;to&quot;</span>,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>                  <span class="at">dir_distance_type =</span> <span class="st">&quot;asymmetric&quot;</span>, </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>                  <span class="at">disp_type =</span> <span class="st">&quot;threshold&quot;</span>, <span class="at">param_u =</span> <span class="dv">0</span>, <span class="at">param_d =</span> <span class="dv">5</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="do">##    name num den      index</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="do">## 1     1   7  61 0.11475410</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="do">## 2     2   6  61 0.09836066</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="do">## 5     5   7  61 0.11475410</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="do">## 3     3   7  61 0.11475410</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="do">## 4     4   6  61 0.09836066</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="do">## 6     6   6  61 0.09836066</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="do">## 7     7   6  61 0.09836066</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="do">## 10   10   7  61 0.11475410</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="do">## 8     8   7  61 0.11475410</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="do">## 9     9   7  61 0.11475410</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="do">## 11   11  10  61 0.16393443</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="do">## 12   12   7  61 0.11475410</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="do">## 13   13   6  61 0.09836066</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="do">## 14   14  11  61 0.18032787</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="do">## 15   15   6  61 0.09836066</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="do">## 16   16   9  61 0.14754098</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="fu">index_calculation</span>(g, <span class="at">c_ij_flag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a>                  <span class="at">dir_distance_type =</span> <span class="st">&quot;asymmetric&quot;</span>,</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>                  <span class="at">index_type =</span> <span class="st">&quot;reach&quot;</span>, <span class="at">index_mode =</span> <span class="st">&quot;to&quot;</span>,</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a>                  <span class="at">disp_type =</span> <span class="st">&quot;threshold&quot;</span>, <span class="at">param_u =</span> <span class="dv">5</span>, <span class="at">param_d =</span> <span class="dv">10</span>)</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="do">##    name num den     index</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="do">## 1     1  23  61 0.3770492</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="do">## 2     2  23  61 0.3770492</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="do">## 5     5  23  61 0.3770492</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="do">## 3     3  14  61 0.2295082</span></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="do">## 4     4  21  61 0.3442623</span></span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a><span class="do">## 6     6  11  61 0.1803279</span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="do">## 7     7  18  61 0.2950820</span></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a><span class="do">## 10   10  22  61 0.3606557</span></span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a><span class="do">## 8     8  14  61 0.2295082</span></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a><span class="do">## 9     9  17  61 0.2786885</span></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a><span class="do">## 11   11  25  61 0.4098361</span></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a><span class="do">## 12   12  23  61 0.3770492</span></span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a><span class="do">## 13   13  17  61 0.2786885</span></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a><span class="do">## 14   14  16  61 0.2622951</span></span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a><span class="do">## 15   15  20  61 0.3278689</span></span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a><span class="do">## 16   16   9  61 0.1475410</span></span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a><span class="fu">index_calculation</span>(g, <span class="at">c_ij_flag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a>                  <span class="at">index_type =</span> <span class="st">&quot;reach&quot;</span>, <span class="at">index_mode =</span> <span class="st">&quot;to&quot;</span>,</span>
<span id="cb13-45"><a href="#cb13-45" tabindex="-1"></a>                  <span class="at">dir_distance_type =</span> <span class="st">&quot;symmetric&quot;</span>, </span>
<span id="cb13-46"><a href="#cb13-46" tabindex="-1"></a>                  <span class="at">disp_type =</span> <span class="st">&quot;threshold&quot;</span>, <span class="at">param =</span> <span class="dv">10</span>)</span>
<span id="cb13-47"><a href="#cb13-47" tabindex="-1"></a><span class="do">##    name num den     index</span></span>
<span id="cb13-48"><a href="#cb13-48" tabindex="-1"></a><span class="do">## 1     1  21  61 0.3442623</span></span>
<span id="cb13-49"><a href="#cb13-49" tabindex="-1"></a><span class="do">## 2     2  25  61 0.4098361</span></span>
<span id="cb13-50"><a href="#cb13-50" tabindex="-1"></a><span class="do">## 5     5  26  61 0.4262295</span></span>
<span id="cb13-51"><a href="#cb13-51" tabindex="-1"></a><span class="do">## 3     3  14  61 0.2295082</span></span>
<span id="cb13-52"><a href="#cb13-52" tabindex="-1"></a><span class="do">## 4     4  16  61 0.2622951</span></span>
<span id="cb13-53"><a href="#cb13-53" tabindex="-1"></a><span class="do">## 6     6  11  61 0.1803279</span></span>
<span id="cb13-54"><a href="#cb13-54" tabindex="-1"></a><span class="do">## 7     7  13  61 0.2131148</span></span>
<span id="cb13-55"><a href="#cb13-55" tabindex="-1"></a><span class="do">## 10   10  30  61 0.4918033</span></span>
<span id="cb13-56"><a href="#cb13-56" tabindex="-1"></a><span class="do">## 8     8  14  61 0.2295082</span></span>
<span id="cb13-57"><a href="#cb13-57" tabindex="-1"></a><span class="do">## 9     9  19  61 0.3114754</span></span>
<span id="cb13-58"><a href="#cb13-58" tabindex="-1"></a><span class="do">## 11   11  32  61 0.5245902</span></span>
<span id="cb13-59"><a href="#cb13-59" tabindex="-1"></a><span class="do">## 12   12  34  61 0.5573770</span></span>
<span id="cb13-60"><a href="#cb13-60" tabindex="-1"></a><span class="do">## 13   13  31  61 0.5081967</span></span>
<span id="cb13-61"><a href="#cb13-61" tabindex="-1"></a><span class="do">## 14   14  25  61 0.4098361</span></span>
<span id="cb13-62"><a href="#cb13-62" tabindex="-1"></a><span class="do">## 15   15  25  61 0.4098361</span></span>
<span id="cb13-63"><a href="#cb13-63" tabindex="-1"></a><span class="do">## 16   16  15  61 0.2459016</span></span></code></pre></div>
</div>
<div id="barriers-prioritization-calculation" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Barriers prioritization
calculation</h1>
<p>The function <code>index_calcualtion</code> allows to calculate the
CCI and RCI changes when barriers are removed. Metadata on which dams
are to be removed and how the passability changes are to be provided in
the ‘dams_metadata’ object. Parallel calculations can be activated.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>dams_metadata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&quot;id_dam&quot;</span> <span class="ot">=</span>  <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;7&quot;</span>),</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>                            <span class="st">&quot;pass_u_updated&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                            <span class="st">&quot;pass_d_updated&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>dams_metadata</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="do">##   id_dam pass_u_updated pass_d_updated</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="do">## 1      1              1              1</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="do">## 2      2              1              1</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="do">## 3      3              1              1</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="do">## 4      4              1              1</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="do">## 5      5              1              1</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="do">## 6      6              1              1</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="do">## 7      7              1              1</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="fu">d_index_calculation</span>(g,</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>                    <span class="at">barriers_metadata =</span> dams_metadata,</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>                    <span class="at">id_barrier =</span> <span class="st">&quot;id_dam&quot;</span>,</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>                    <span class="at">parallel =</span> <span class="cn">FALSE</span>, <span class="at">ncores =</span> <span class="dv">3</span>,</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>                    <span class="at">param_u =</span> <span class="dv">10</span>,  <span class="at">param_d =</span> <span class="dv">10</span>, <span class="at">param =</span> <span class="fl">0.5</span>,</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>                    <span class="at">index_type =</span> <span class="st">&quot;full&quot;</span>,</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>                    <span class="at">dir_distance_type =</span> <span class="st">&quot;asymmetric&quot;</span>,</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>                    <span class="at">disp_type =</span> <span class="st">&quot;threshold&quot;</span>)</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="do">##   id_dam      num  den     index  index_bl   d_index</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="do">## 1      1 759.0978 3721 0.2040037 0.1998951  2.055376</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="do">## 2      2 897.4074 3721 0.2411737 0.1998951 20.650131</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="do">## 3      3 784.4321 3721 0.2108122 0.1998951  5.461397</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="do">## 4      4 768.5105 3721 0.2065333 0.1998951  3.320849</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="do">## 5      5 911.6736 3721 0.2450077 0.1998951 22.568122</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="do">## 6      6 834.9497 3721 0.2243885 0.1998951 12.253134</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="do">## 7      7 855.4097 3721 0.2298871 0.1998951 15.003837</span></span></code></pre></div>
</div>
<div id="references-and-key-literature" class="section level1" number="5">
<h1><span class="header-section-number">5</span> References and key
literature</h1>
<p>Belletti, Barbara, et al. “More than one million barriers fragment
Europe’s rivers.” Nature 588.7838 (2020): 436-441.</p>
<p>Cote, D., Kehler, D. G., Bourne, C., &amp; Wiersma, Y. F. (2009). A
new measure of longitudinal connectivity for stream networks. Landscape
Ecology, 24(1), 101-113.</p>
<p>Kolaczyk, E. D., &amp; Csárdi, G. (2014). Statistical analysis of
network data with R (Vol. 65). New York: Springer.</p>
<p>Jumani, S., Deitch, M. J., Kaplan, D., Anderson, E. P., Krishnaswamy,
J., Lecours, V., &amp; Whiles, M. R. (2020). River fragmentation and
flow alteration metrics: a review of methods and directions for future
research. Environmental Research Letters.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
